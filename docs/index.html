<!DOCTYPE html>
<html lang="en">
<!-- Documentation generated by LuaDox: https://github.com/jtackaberry/luadox -->
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
    <title>How to create an extension - Extension API Reference</title>
	<link href="prism.css?7653a2d" rel="stylesheet" />
    <link rel="stylesheet" href="luadox.css?7653a2d" type="text/css">
    
</head>
<body class="manual-index">
<div class="topbar">
<div class="group one">
<div class="button description"><a href="index.html"><span>OpenFunscripter | Extension API</span></a></div>
</div>
<div class="group two">
</div>
<div class="group three">
<div class="button iconright"><a href="class/Action.html" title="Action"><span>Next</span><img src="img/i-right.svg?7653a2d" alt=""/></a></div>
</div>
</div>
<div class="sidebar">
<form action="search.html">
<input class="search" name="q" type="search" placeholder="Search" />
</form>
<div class="sections">
<div class="heading">Contents</div>
<ul>
<li><a href="#how_to_create_an_extension">How to create an extension</a></li>
<li><a href="#extension_structure">Extension Structure</a></li>
<li><a href="#keybindings">Keybindings</a></li>
<li><a href="#custom_ui">Custom UI</a></li>
</ul>
</div>
<div class="manual">
<div class="heading">Manual</div>
<ul>
<li class="selected"><a href="index.html">How to create an extension</a></li>
</ul>
</div>
<div class="classes">
<div class="heading">Classes</div>
<ul>
<li><a href="class/Action.html">Action</a></li>
<li><a href="class/Funscript.html">Funscript</a></li>
<li><a href="class/Process.html">Process</a></li>
</ul>
</div>
<div class="modules">
<div class="heading">Modules</div>
<ul>
<li><a href="module/ofs.html">ofs</a></li>
<li><a href="module/player.html">player</a></li>
<li><a href="module/action.html">action</a></li>
<li><a href="module/process.html">process</a></li>
</ul>
</div>
</div>
<div class="body">
<div class="manual">
<h1 id="how_to_create_an_extension">How to create an extension
<a class="permalink" href="#how_to_create_an_extension" title="Permalink to this definition">¶</a>
</h1>
<ul>
<li><a href="#how-to-create-an-extension">How to create an extension</a></li>
<li><a href="#extension-structure">Extension Structure</a></li>
<li><a href="#keybindings">Keybindings</a></li>
<li><a href="#custom-ui">Custom UI</a></li>
</ul>

<h1 id="extension_structure">Extension Structure
<a class="permalink" href="#extension_structure" title="Permalink to this definition">¶</a>
</h1>
<p>Extension live in the <code>%appdata%/OFS_data/extensions/</code> directory.<br />
An extension must have it's own directory with a <code>main.lua</code> in it.<br />
By default there is a <code>Core</code> extension which serves as a demo.</p>
<pre><code>OFS_data
|-- extensions
   |-- Core
      |-- main.lua
</code></pre>
<p>In OFS extensions become available trough the main menu bar <code>Extensions</code> and must be enabled before they can be used.</p>
<p>The <code>main.lua</code> must define three functions otherwise it just won't work.</p>
<pre><code class="language-lua">function init()
    -- this runs once when enabling the extension
end

function update(delta)
    -- this runs every OFS frame
    -- delta is the time since the last call in seconds
    -- doing heavy computation here will lag OFS
end

function gui()
    -- this only runs when the window is open
    -- this is the place where a custom gui can be created
    -- doing heavy computation here will lag OFS
end
</code></pre>
<p>A new optional function which can be defined is <code>scriptChange(scriptIdx)</code>.</p>
<pre><code class="language-lua">function scriptChange(scriptIdx) 
    -- is called when a funscript gets changed in some way
    -- this can be used for validation ???
    local s = ofs.Script(scriptIdx)
end
</code></pre>

<h1 id="keybindings">Keybindings
<a class="permalink" href="#keybindings" title="Permalink to this definition">¶</a>
</h1>
<p>Keybindings are created by adding them to a global <code>binding</code> table <strong>before</strong> <code>init()</code> is called.<br />
This must be done in global scope.</p>
<pre><code class="language-lua">-- In both cases you can still call these functions as binding.keybinding1() &amp; binding.keybinding2()
-- clean way
function binding.keybinding1()
-- do something
end

-- OR

-- savage way
binding.keybinding2 = function()
-- do something
end
</code></pre>

<h1 id="custom_ui">Custom UI
<a class="permalink" href="#custom_ui" title="Permalink to this definition">¶</a>
</h1>
<p>GUI functions must be called from within the <em>gui()</em> function.<br />
A list of functions can be found <a href="/module/ofs.html#gui">here</a>.
You can't pass values by reference in Lua which is why things like <a href="module/ofs.html#ofs.Slider"><code>ofs.Slider</code></a> have multiple return values.</p>
<pre><code class="language-Lua">x = 0 -- global value x

function gui()
    x, valueChanged = ofs.Slider(&quot;x&quot;, x, 0, 100) -- slider min: 0 &amp; max: 100
    if valueChanged then
        print(&quot;The value changed!&quot;)
    end
end
</code></pre>
<p><strong>When using multiple controls with the same name you have to give them a unique id.</strong>
<br>This applies to all controls not just buttons.</p>
<pre><code class="language-Lua">function gui()
    -- THIS WON'T WORK
    if ofs.Button(&quot;Apply&quot;) then
        -- do something
    end
    if ofs.Button(&quot;Apply&quot;) then
        -- do something
    end

    -- Do this instead
    -- unique id &quot;ApplyBtn1&quot;
    if ofs.Button(&quot;Apply##ApplyBtn1&quot;) then
        -- do something
    end
    -- unique id &quot;ApplyBtn2&quot;
    if ofs.Button(&quot;Apply##ApplyBtn2&quot;) then
        -- do something
    end
end
</code></pre>

</div>
</div>
<script src="prism.js?7653a2d"></script>
</body>
</html>